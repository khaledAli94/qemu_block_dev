{
    "configurations": [
    {
        "name": "ARM-QEMU",
        "type": "cppdbg",
        "request": "launch",
        "cwd": ".",
        "program": "${workspaceFolder}/src/bootloader.elf",
        "MIMode": "gdb",
        "stopAtConnect":true,
        "stopAtEntry": true,
        "miDebuggerPath": "arm-none-linux-gnueabihf-gdb",
        "miDebuggerServerAddress": "localhost:1234",
        "miDebuggerArgs": "-q",
        "targetArchitecture": "arm",
        
        "setupCommands": [
            { "text": "-enable-pretty-printing" }, // Enables IDE-level formatting (e.g., for C++ STL or complex types)
            { "text": "set print pretty on" }, // Formats structs vertically with indentation (easier to read)
            { "text": "set output-radix 16" }, // Forces all integer values to display in HEX by default
            { "text": "set print elements 0" }, //Prints every single item in an array or string, default 200 elment
            { "text": "set print address on" }, // Shows the memory address (0x...) next to pointer values
            { "text": "set print array on" }, // Prints each array element on its own line (cleaner visualization)
            { "text": "set print union on" }, // Expands 'union' types inside structs so you can see their values
            { "text": "set architecture arm" },
            { "text": "set endian little" },
            { "text": "set confirm off" }, // Disables "Are you sure?" prompts (prevents IDE hangs)
            { "text": "set pagination off" }, // Disables "Press Enter to continue" for long output (prevents IDE hangs)
            { "text": "set history save on" }, // Saves your GDB command history to a file for next session
            { "text": "set verbose on" },
                      
            // --- CRITICAL ERRORS (STOP & INVESTIGATE) ---
            // These indicate a genuine bug in your kernel (bad pointer, math error).
            { "text": "handle SIGSEGV stop print pass" },  // Segmentation Fault: Writing to invalid memory.
            { "text": "handle SIGFPE stop print pass" },   // Floating Point Exception: Division by zero / overflow.
            { "text": "handle SIGABRT stop print pass" },  // Abort: Triggered by assert() failures or kernel panic.

            // --- USER CONTROL (STOP & INTERACT) ---
            // These allow you to manually pause execution or terminate cleanly.
            { "text": "handle SIGINT stop print nopass" }, // Interrupt: Catches Ctrl+C so you can pause the debugger.
            { "text": "handle SIGTERM stop print pass" },  // Termination: Signal to quit the program.

            // --- QEMU NOISE / FALSE ALARMS (IGNORE) ---
            // These are often triggered by QEMU internals or early hardware probing.
            // Stopping on these usually prevents the kernel from booting.
            { "text": "handle SIGILL nostop noprint pass" },  // Illegal Instruction: Common during CPU feature probing.
            { "text": "handle SIGBUS nostop noprint pass" },  // Bus Error: Common when checking if hardware exists.
            { "text": "handle SIGALRM nostop noprint pass" }, // Alarm: Used by QEMU/Linux timers; not a crash.
            { "text": "handle SIGPIPE nostop noprint pass" }, // Broken Pipe: Common in some I/O operations; rarely fatal.
                
            // --- DEBUGGING TRAPS (CONTEXT DEPENDENT) ---
            // If you use hardcoded 'asm("bkpt")' breakpoints, change this to 'stop'.
            // If you only use VS Code's red-dot breakpoints, keep it 'nostop'.
            { "text": "handle SIGTRAP nostop noprint pass" }
        ]
    }
    ]
}